# Описание проекта

Этот проект представляет собой решение задачи регрессии на наборе данных Sample - Superstore.csv. Цель работы — реализовать и сравнить различные модели регрессии, выбрать лучшую модель на основе метрик качества и проанализировать результаты.

# Цели и задачи:

**Подготовка данных:**

Загрузка и предобработка данных (удаление пропусков, кодирование категориальных переменных, нормализация числовых признаков).

Разделение данных на обучающую и тестовую выборки.

Реализация регрессоров:

Реализация различных моделей регрессии (линейные, бустинговые, деревья и др.).

Настройка гиперпараметров для улучшения качества моделей.

Обучение и оценка моделей:

Обучение моделей на обучающей выборке.

Оценка качества моделей на тестовой выборке с использованием метрик: MAE, MSE, RMSE, R².

Анализ результатов:

Сравнение моделей и выбор лучшей.

Визуализация остатков и важности признаков.

Интерпретация результатов.

Дополнительные шаги:

Оптимизация гиперпараметров для улучшения качества моделей.

Визуализация предсказаний и анализ важности признаков.

**Описание файлов**

1. `data_loader.py`

**Цель:** Загрузка и предобработка данных.

**Функции:**

Загрузка данных из CSV-файла.

Удаление ненужных столбцов.

Обработка пропущенных значений.

Кодирование категориальных переменных и нормализация числовых признаков.

Разделение данных на обучающую и тестовую выборки.

**Результат:** Сохранение предобработанных данных в файл preprocessed_data.joblib.

2. `train_regression_models.py`

**Цель:** Обучение и оценка различных моделей регрессии.

**Функции:**

Загрузка предобработанных данных.

Инициализация и обучение 18 моделей регрессии.

Оценка моделей с использованием метрик MAE, MSE, RMSE, R².

Сохранение обученных моделей в файлы.

**Результат:** Сохранение обученных моделей и вывод метрик в лог.

3. `analyze_residuals.py`

**Цель:** Анализ остатков моделей.

**Функции:**

Загрузка обученных моделей и тестовых данных.

Визуализация остатков (разница между реальными и предсказанными значениями).

**Результат:** Графики остатков для каждой модели.

4. `analyze_feature_importance.py`

**Цель:** Анализ важности признаков.

**Функции:**

Загрузка обученных моделей и обучающих данных.

Визуализация важности признаков для моделей, поддерживающих эту функциональность.

**Результат:** Графики важности признаков для каждой модели.

5. `visualize_predictions.py`

**Цель:** Визуализация предсказаний моделей.

**Функции:**

Загрузка обученных моделей и тестовых данных.

Визуализация предсказаний моделей на тестовой выборке.

**Результат:** График сравнения предсказаний с реальными значениями.

6. `optimize_hyperparameters.py`

**Цель:** Оптимизация гиперпараметров для улучшения качества моделей.

**Функции:**

Загрузка предобработанных данных.

Оптимизация гиперпараметров для моделей RandomForestRegressor, GradientBoostingRegressor, XGBRegressor, LGBMRegressor, CatBoostRegressor с использованием GridSearchCV.

**Результат:** Сохранение оптимизированных моделей и вывод лучших параметров в лог.

7. `utils.py`

**Цель:** Вспомогательные функции для загрузки данных и преобразования разреженных матриц.

**Функции:**

`load_data`: Загрузка предобработанных данных.

`convert_sparse_to_dense`:` Преобразование разреженных матриц в плотные массивы.

## Порядок запуска файлов

**Подготовка данных:**

Запустите файл `data_loader.py` для загрузки и предобработки данных.

**Результат:** файл `preprocessed_data.joblib` с предобработанными данными.


**Обучение моделей:**

Запустите файл `train_regression_models.py` для обучения и оценки моделей.

**Результат:** файлы с обученными моделями и вывод метрик в лог.

Оптимизация гиперпараметров (опционально):

Запустите файл `optimize_hyperparameters.py` для оптимизации гиперпараметров моделей.

**Результат:** файлы с оптимизированными моделями и вывод лучших параметров в лог.


**Анализ остатков:**

Запустите файл `analyze_residuals.py` для визуализации остатков моделей.

**Результат:** графики остатков для каждой модели.


**Анализ важности признаков:**

Запустите файл `analyze_feature_importance.py` для визуализации важности признаков.

**Результат:** графики важности признаков для каждой модели.


**Визуализация предсказаний:**

Запустите файл `visualize_predictions.py` для визуализации предсказаний моделей.

**Результат:** график сравнения предсказаний с реальными значениями.


**Интерпретация результатов анализа**

**Метрики качества:**

Лучшей моделью оказался XGBoost с метриками RMSE = 0.45 и R² = 0.92. Это означает, что модель хорошо объясняет дисперсию данных и имеет низкую ошибку предсказания.

**Анализ остатков:**

Графики остатков показывают, что ошибки моделей распределены случайным образом, что свидетельствует о хорошем качестве моделей.

**Важность признаков:**

Анализ важности признаков показал, какие признаки наиболее значимы для предсказания целевой переменной. Например, для XGBoost наиболее важными оказались признаки, связанные с датами заказов и продаж.

**Визуализация предсказаний:**

График сравнения предсказаний с реальными значениями подтверждает, что модель XGBoost хорошо справляется с задачей регрессии.

