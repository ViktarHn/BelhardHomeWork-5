# Описание проекта

Этот проект представляет собой решение задачи регрессии на наборе данных `Sample - Superstore.csv`. Цель работы — реализовать и сравнить различные модели регрессии, выбрать лучшую модель на основе метрик качества, а также улучшить её с помощью feature engineering, оптимизации гиперпараметров и ансамблирования моделей.

## Структура проекта

## Основные файлы:

`data_loader.py`

`feature_engineering.py`

`train_regression_models.py`

`optimize_hyperparameters.py`

`stacking_models.py`

`analyze_residuals.py`

`analyze_feature_importance.py`

`visualize_predictions.py`

`utils.py`


## Описание файлов

1. `data_loader.py`

**Задача:** Загрузка и предобработка данных.

**Функции:**

Загружает данные из CSV-файла.

Удаляет ненужные столбцы.

Обрабатывает пропуски, кодирует категориальные переменные, нормализует числовые признаки.

Разделяет данные на обучающую и тестовую выборки.

**Результат:**

`preprocessed_data.joblib` — предобработанные данные.

`preprocessor.joblib` — препроцессор для преобразования данных.

2. `feature_engineering.py`

**Задача:** Создание новых признаков и обновление данных.

**Функции:**

Создает новые признаки (взаимодействие между признаками, полиномиальные признаки, временные признаки).

Применяет предобработку данных с учетом новых признаков.

**Результат:**

`data_with_new_features.csv` — данные с новыми признаками.

`preprocessor_with_new_features.joblib` — обновленный препроцессор.

3. `train_regression_models.py`

**Задача:** Обучение и оценка моделей регрессии.

**Функции:**

Обучает различные модели регрессии (линейные, бустинговые, деревья и др.).

Оценивает качество моделей на тестовой выборке с использованием метрик MAE, MSE, RMSE, R².

**Результат:**

Обученные модели (например, `linear_regression_model.joblib`, `random_forest_model.joblib`).

Метрики качества для каждой модели.

4. `optimize_hyperparameters.py`

**Задача:** Оптимизация гиперпараметров моделей.

**Функции:**

Использует RandomizedSearchCV для поиска лучших гиперпараметров для моделей (RandomForestRegressor, GradientBoostingRegressor, XGBRegressor, LGBMRegressor, CatBoostRegressor).

**Результат:**

Оптимизированные модели (например, `optimized_random_forest_model.joblib`).

Лучшие параметры для каждой модели.

5. `stacking_models.py`

**Задача:** Реализация стекинга моделей.

**Функции:**

Создает ансамбль из нескольких базовых моделей и одной мета-модели.

Оценивает качество стекинга с помощью кросс-валидации.

**Результат:**

`stacking_model.joblib` — обученная модель стекинга.

Метрики качества на тестовой выборке.

6. `analyze_residuals.py`

**Задача:** Анализ остатков моделей.

**Функции:**

Визуализирует разницу между реальными и предсказанными значениями для каждой модели.

**Результат:**

Графики остатков для каждой модели.

7. `analyze_feature_importance.py`

**Задача**: Анализ важности признаков.

**Функции:**

Визуализирует важность признаков для моделей, поддерживающих эту функциональность (например, RandomForestRegressor, GradientBoostingRegressor, XGBoost, CatBoost).

**Результат:**

Графики важности признаков для каждой модели.

8. `visualize_predictions.py`

**Задача:** Визуализация предсказаний моделей.

**Функции:**

Сравнивает предсказания моделей с реальными значениями на тестовой выборке.

**Результат:**

График сравнения предсказаний с реальными значениями.

9. `utils.py`

**Задача:** Вспомогательные функции.

**Функции:**

`load_data`: Загружает предобработанные данные.

`convert_sparse_to_dense`: Преобразует разреженные матрицы в плотные массивы.

**Результат:**

Упрощает работу с данными в других файлах.

# Последовательность запуска файлов

`data_loader.py`

Загружает и предобрабатывает данные.

**Результат:** `preprocessed_data.joblib`, `preprocessor.joblib`.

`feature_engineering.py`

Создает новые признаки и обновляет данные.

**Результат:** `data_with_new_features.csv`, `preprocessor_with_new_features.joblib`.

`train_regression_models.py`

Обучает модели и оценивает их качество.

**Результат:** Обученные модели и метрики качества.

`optimize_hyperparameters.py`

Оптимизирует гиперпараметры для моделей.

**Результат:** Оптимизированные модели и лучшие параметры.

`stacking_models.py`

Обучает модель стекинга.

**Результат:** `stacking_model.joblib`.

`analyze_residuals.py`

Анализирует остатки моделей.

**Результат:** Графики остатков.

`analyze_feature_importance.py`

Анализирует важность признаков.

**Результат:** Графики важности признаков.

`visualize_predictions.py`

Визуализирует предсказания моделей.

**Результат:* График сравнения предсказаний с реальными значениями.

# Итоговая картина

`data_loader.py` и `feature_engineering.py` подготавливают данные.

`train_regression_models.py` и `optimize_hyperparameters.py` обучают и оптимизируют модели.

`stacking_models.py` создает ансамбль моделей.

`analyze_residuals.py`, `analyze_feature_importance.py` и `visualize_predictions.py` анализируют и визуализируют результаты.

`utils.py` содержит вспомогательные функции для работы с данными.

# Заключение

Проект позволяет:

Подготовить данные для задачи регрессии.

Обучить и оптимизировать различные модели.

Создать ансамбль моделей для улучшения качества предсказаний.

Проанализировать и визуализировать результаты.

